using gold.structures.automaton.*
using gold.visualization.automaton.*

procedure main(args:String[]) begin
	Q := {"qFORWAR", "qRIGHT_N_", "qFO", "qREPE", "qREPEAT", "qPENUP", "q.", "qRIGHT_", "qPEN", "qP",
	      "qPENDO", "qRT_", "qFORWARD_N", "qF", "qRIGH", "qFORWARD_N_", "qFORWA", "qLEFT", "qLT_N",
	      "qPENUP_", "qLEFT_", "qPENDOW", "qREPEAT_N_", "qRIGHT_N", "qFORWARD_", "qREP", "qREPEAT_N",
	      "qPENU", "qPENDOWN", "qFOR", "qLEFT_N", "qRT_N_", "qRE", "qRIG", "qFORW", "qLT", "qFD",
	      "qFORWARD", "qPEND", "qFD_N", "qLT_N_", "qREPEA", "qL", "qREPEAT_", "qPENDOWN_", "qFD_",
	      "qRI", "qLEFT_N_", "qRT", "qRIGHT", "qLE", "qR", "qFD_N_", "qRT_N", "qLEF", "qPE", "qLT_",
	      "qAbre", "qAbre_", "qCierra", "qCierra_",
	      "q._", "B", "q0"}
	Σ := {'F', 'O', 'R', 'W', 'A', 'R', 'D',  
	      'I', 'G', 'H', 'T', 
	      'L', 'E',
	      'P', '[', ']',
	      'N', 'U',
	      '.',
	      '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ' '}
	Γ := {'N', 'T', '1', '2', '3', '4', '5', '6', ']', '[', ' '}
	q := "q0"
	F := {"q0", "q.", "q._"}
	
	A := GDeterministicTransducer(Q, Σ, Γ, q, F, δ, g, h)
	GAutomataFrame.show(A)
end

function δ(q, σ) begin
	if σ = 'F' and q = "q0" then
        return "qF"
    elseif σ = 'O' and q = "qF" then
        return "qFO"
    elseif σ = 'R' and q = "qFO" then
        return "qFOR"
    elseif σ = 'W' and q = "qFOR" then
        return "qFORW"
    elseif σ = 'A' and q = "qFORW" then
        return "qFORWA"
    elseif σ = 'R' and q = "qFORWA" then
        return "qFORWAR"
    elseif σ = 'D' and q = "qFORWAR" then
        return "qFORWARD"
    elseif q = "qFORWARD" and σ = ' ' then
        return "qFORWARD_"
    elseif q = "qFORWARD_" and σ = ' ' then
        return "qFORWARD_"
    elseif q = "qFORWARD_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qFORWARD_N"
    elseif q = "qFORWARD_N" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return  "qFORWARD_N"
    elseif σ = ' ' and (q = "qFORWARD_N" or q = "qFORWARD_N_")then
        return "qFORWARD_N_"
    elseif σ = '.' and q = "qFORWARD_N" then
        return "q."
    elseif σ = '.' and q = "qFORWARD_N_" then
        return "q."

    elseif σ = 'F' and q = "q0" then
        return "qF"
    elseif σ = 'D' and q = "qF" then
        return "qFD"
    elseif q = "qFD" and σ = ' ' then
        return "qFD_"
    elseif q = "qFD_" and σ = ' ' then
        return "qFD_"
    elseif q = "qFD_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qFD_N"
    elseif q = "qFD_N" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return  "qFD_N"
    elseif σ = ' ' and (q = "qFD_N" or q = "qFD_N_")then
        return "qFD_N_"
    elseif σ = '.' and q = "qFD_N" then
        return "q."
    elseif σ = '.' and q = "qFD_N_" then
        return "q."

    elseif σ = 'R' and q = "q0" then
        return "qR"
    elseif σ = 'I' and q = "qR" then
        return "qRI"
    elseif σ = 'G' and q = "qRI" then
        return "qRIG"
    elseif σ = 'H' and q = "qRIG" then
        return "qRIGH"
    elseif σ = 'T' and q = "qRIGH" then
        return "qRIGHT"
    elseif q = "qRIGHT" and σ = ' ' then
        return "qRIGHT_"
    elseif q = "qRIGHT_" and σ = ' ' then
        return "qRIGHT_"
    elseif q = "qRIGHT_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qRIGHT_N"
    elseif q = "qRIGHT_N" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return  "qRIGHT_N"
    elseif σ = ' ' and (q = "qRIGHT_N" or q = "qRIGHT_N_")then
        return "qRIGHT_N_"
    elseif σ = '.' and q = "qRIGHT_N" then
        return "q."
    elseif σ = '.' and q = "qRIGHT_N_" then
        return "q."

    elseif σ = 'R' and q = "q0" then
        return "qR"
    elseif σ = 'T' and q = "qR" then
        return "qRT"
    elseif q = "qRT" and σ = ' ' then
        return "qRT_"
    elseif q = "qRT_" and σ = ' ' then
        return "qRT_"
    elseif q = "qRT_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qRT_N"
    elseif q = "qRT_N" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return  "qRT_N"
    elseif σ = ' ' and (q = "qRT_N" or q = "qRT_N_")then
        return "qRT_N_"
    elseif σ = '.' and q = "qRT_N" then
        return "q."
    elseif σ = '.' and q = "qRT_N_" then
        return "q."

    elseif σ = 'L' and q = "q0" then
        return "qL"
    elseif σ = 'E' and q = "qL" then
        return "qLE"
    elseif σ = 'F' and q = "qLE" then
        return "qLEF"
    elseif σ = 'T' and q = "qLEF" then
        return "qLEFT"
    elseif q = "qLEFT" and σ = ' ' then
        return "qLEFT_"
    elseif q = "qLEFT_" and σ = ' ' then
        return "qLEFT_"
    elseif q = "qLEFT_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qLEFT_N"
    elseif q = "qLEFT_N" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return  "qLEFT_N"
    elseif σ = ' ' and (q = "qLEFT_N" or q = "qLEFT_N_")then
        return "qLEFT_N_"
    elseif σ = '.' and q = "qLEFT_N" then
        return "q."
    elseif σ = '.' and q = "qLEFT_N_" then
        return "q."

    elseif σ = 'L' and q = "q0" then
        return "qL"
    elseif σ = 'T' and q = "qL" then
        return "qLT"
    elseif q = "qLT" and σ = ' ' then
        return "qLT_"
    elseif q = "qLT_" and σ = ' ' then
        return "qLT_"
    elseif q = "qLT_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qLT_N"
    elseif q = "qLT_N" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return  "qLT_N"
    elseif σ = ' ' and (q = "qLT_N" or q = "qLT_N_")then
        return "qLT_N_"
    elseif σ = '.' and q = "qLT_N" then
        return "q."
    elseif σ = '.' and q = "qLT_N_" then
        return "q."

    elseif σ = 'R' and q = "q0" then
        return "qR"
    elseif σ = 'E' and q = "qR" then
        return "qRE"
    elseif σ = 'P' and q = "qRE" then
        return "qREP"
    elseif σ = 'E' and q = "qREP" then
        return "qREPE"
    elseif σ = 'A' and q = "qREPE" then
        return "qREPEA"
    elseif σ = 'T' and q = "qREPEA" then
        return "qREPEAT"
    elseif q = "qREPEAT" and σ = ' ' then
        return "qREPEAT_"
    elseif q = "qREPEAT_" and σ = ' ' then
        return "qREPEAT_"
    elseif q = "qREPEAT_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qREPEAT_N"
    elseif q = "qREPEAT_N" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return  "qREPEAT_N"
    elseif σ = ' ' and (q = "qREPEAT_N" or q = "qREPEAT_N_")then
        return "qREPEAT_N_"
    elseif σ = '.' and q = "qREPEAT_N" then
        return "q."
    elseif σ = '.' and q = "qREPEAT_N_" then
        return "q."

    elseif σ = 'P' and q = "q0" then
        return "qP"
    elseif σ = 'E' and q = "qP" then
        return "qPE"
    elseif σ = 'N' and q = "qPE" then
        return "qPEN"
    elseif σ = 'U' and q = "qPEN" then
        return "qPENU"
    elseif σ = 'P' and q = "qPENU" then
        return "qPENUP"
    elseif q = "qPENUP" and σ = ' ' then
        return "qPENUP_"
    elseif q = "qPENUP_" and σ = ' ' then
        return "qPENUP_"
    elseif σ = '.' and q = "qPENUP_" then
        return "q."

    elseif σ = 'P' and q = "q0" then
        return "qP"
    elseif σ = 'E' and q = "qP" then
        return "qPE"
    elseif σ = 'N' and q = "qPE" then
        return "qPEN"
    elseif σ = 'D' and q = "qPEN" then
        return "qPEND"
    elseif σ = 'O' and q = "qPEND" then
        return "qPENDO"
    elseif σ = 'W' and q = "qPENDO" then
        return "qPENDOW"
    elseif σ = 'N' and q = "qPENDOW" then
        return "qPENDOWN"
    elseif q = "qPENDOWN" and σ = ' ' then
        return "qPENDOWN_"
    elseif q = "qPENDOWN_" and σ = ' ' then
        return "qPENDOWN_"
    elseif σ = '.' and q = "qPENDOWN_" then
        return "q."
        
    elseif σ = ' ' and q = "q0" then
    	return "q0"
    elseif σ = ' ' and (q = "q." or q = "q._") then
        return "q._"
    elseif σ = ' ' and q = "qREPEAT_N" then
        return "qREPEAT_N_"  
	elseif σ = '[' and (q = "qREPEAT_N" or q = "qREPEAT_N_") then
        return "qAbre"	
    elseif σ = ' ' and q = "qAbre" then
        return "qAbre_"	
    elseif σ = ' ' and q = "qAbre_" then
        return "qAbre_"    
    elseif σ = ']' and (q = "q." or q = "q._") then
        return "qCierra"
    elseif σ = ' ' and q = "qCierra" then
        return "qCierra_"
    elseif σ = ' ' and q = "qCierra_" then
        return "qCierra_"
    elseif σ = '.' and (q = "qCierra" or q = "qCierra_") then
        return "q."
    
    elseif σ = 'P' and (q = "q." or q = "q._" or q = "qAbre" or q = "qAbre_") then
        return "qP"
    elseif σ = 'F' and (q = "q." or q = "q._" or q = "qAbre" or q = "qAbre_") then
        return "qF"
    elseif σ = 'R' and (q = "q." or q = "q._" or q = "qAbre" or q = "qAbre_") then
        return "qR"
    elseif σ = 'L' and (q = "q." or q = "q._" or q = "qAbre" or q = "qAbre_") then
        return "qL"

   elseif q = "qFORWARDN"  and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qFORWARDN"
    elseif q = "qRIGHTN"  and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qRIGHTN"
    elseif q = "qLEFTN"  and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qLEFTN"
    elseif q = "qREPEATN"  and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qREPEATN"
    elseif q = "qFDN"  and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qFDN"
    elseif q = "qRTN"  and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qRTN"
    elseif q = "qLTN"  and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "qLTN"

    else
        return "B"
    end
end

function g(q) begin
	return λ
end

function h(q, σ) begin
    if σ = 'N' and q = "qPENDOW" then
        return "T1"
    elseif σ = 'D' and (q = "qFORWAR" or q = "qF") then
        return "T2"
    elseif σ = 'T' and (q = "qRIGH" or q = "qR") then
        return "T3"
    elseif σ = 'T' and (q = "qLEF" or q = "qL") then
        return "T4"
    elseif σ = 'T' and q = "qREPEA" then
        return "T5"
    elseif σ = 'P' and q = "qPENU" then
        return "T6"
        
    elseif q = "qFORWARD_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "N"
    elseif q = "qRIGHT_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "N"
    elseif q = "qLEFT_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "N"
    elseif q = "qREPEAT_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "N"
    elseif q = "qFD_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "N"
    elseif q = "qLT_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "N"
    elseif q = "qRT_" and (σ = '0' or σ = '1' or σ = '2' or σ = '3' or σ = '4' or σ = '5' or σ = '6' or σ = '7' or σ = '8' or σ = '9') then
        return "N"
        
    elseif σ = '[' and (q = "qREPEAT_N_" or q = "qREPEAT_N") then
    	return "["
    elseif σ = ']' and (q = "q." or q = "q._") then
    	return "]"
    else
    	return λ
    end
end